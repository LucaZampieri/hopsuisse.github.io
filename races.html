---
layout: page
title: Races
permalink: /races/
---

<div id="searchfield">
  <h3>Search for a race :</h3>
  <form><input type="text" name="race" class="biginput" id="autocomplete"></form>
</div><!-- @end #searchfield -->

<div id="outputbox">
  <p id="outputcontent">Choose a race and the results will display here.</p>
</div>

<div id="chart"></div>

<script type="text/javascript">
$(function(){
  var races = [
    {% for id in site.data.races %}
    {value: "{{ id[1]["race"]}} ({{ id[1]["date"] }})", data: {{ id[1] | jsonify }}},
    {% endfor %}
  ];
  $('#autocomplete').autocomplete({
    lookup: races,
    onSelect: function (suggestion) {
      // Create a simple bar plot
      var chart = c3.generate({
          bindto: '#chart',
          data: {
            columns: [
              ['count', suggestion.data.M, suggestion.data.F]
            ],
            type: 'bar'
          },
          axis: {
            x: {
              type: 'category',
              categories: ['male', 'female']
            }
          }
      });
      // Display basic info
      var thehtml = 
        '<strong>Race:</strong> ' + suggestion.data.race + '<br/>' +
        '<strong>Date:</strong> ' + suggestion.data.date + '<br/>' +
        '<strong>Participants:</strong> ' + suggestion.data.count + '<br/>' +
        '<strong>Men:</strong> ' + suggestion.data.M + '<br/>' +
        '<strong>Women:</strong> ' + suggestion.data.F + '<br/>';
      $('#outputcontent').html(thehtml);
    }
  });
});
</script>

